<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  layout:decorate="~{/layouts/layout}"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Post</title>
    <link rel="stylesheet" th:href="@{/css/board/register.css}" />
  </head>
  <body>
    <div layout:fragment="content">
      <div class="write-content">
        <div class="write-article">
          <!-- boardDto 확인 -->
          <p th:if="${boardDto == null}" class="text-danger">
            boardDto 객체가 전달되지 않았습니다.
          </p>
          <form
            th:action="@{/board/register}"
            method="POST"
            enctype="multipart/form-data"
            class="blog-article"
          >
            <input type="hidden" name="_csrf" th:value="${_csrf.token}" />
            <div class="write-article-header">
              <p class="new-post">New Post</p>
              <div class="form-group">
                <label for="category"></label>
                <select
                  id="category"
                  name="categoryId"
                  class="form-control"
                  required
                >
                  <option value="" disabled selected>Category</option>
                  <option
                    th:each="category : ${categories}"
                    th:value="${category.boardCNo}"
                    th:text="${category.name}"
                    th:selected="${boardDto.categoryId == category.boardCNo}"
                  ></option>
                </select>
                <p th:if="${categories == null || #lists.isEmpty(categories)}" class="text-danger">
                  카테고리를 불러올 수 없습니다.
                </p>
              </div>
              <div class="form-group">
                <label for="title"></label>
                <input
                  type="text"
                  id="title"
                  name="title"
                  class="form-control"
                  placeholder="제목을 입력하세요"
                  th:value="${boardDto.title}"
                  required
                />
                <div th:if="${#fields.hasErrors('title')}" class="text-danger">
                  <p th:errors="*{title}"></p>
                </div>
              </div>
            </div>
            <div class="article-img">
              <label for="image">이미지 업로드</label>
              <input
                type="file"
                id="image"
                name="image"
                class="form-control"
                accept="image/jpeg, image/png, image/gif"
                onchange="previewImage(event)"
              />
              <div id="image-preview" class="mt-2">
                <img id="preview" src="" alt="미리보기" style="max-width: 100%; display: none;" />
              </div>
              <div
                th:if="${boardDto.imageFileName != null}"
                class="existing-image"
              >
                <p>
                  현재 이미지: <span th:text="${boardDto.imageFileName}"></span>
                </p>
              </div>
            </div>
            <div class="write-article-body">
              <div class="form-group">
                <label for="content">본문</label>
                <textarea
                  id="content"
                  name="content"
                  rows="10"
                  class="form-control"
                  placeholder="게시물에 음란물, 타인의 권리 침해, 명예 훼손이 포함된 경우, 별도의 통보 없이 제재를 받을 수 있습니다."
                  th:text="${boardDto.content}"
                  required
                ></textarea>
                <div th:if="${#fields.hasErrors('content')}" class="text-danger">
                  <p th:errors="*{content}"></p>
                </div>
              </div>
            </div>
            <div class="form-group text-center">
              <button type="submit" class="btn btn-primary submit-btn">
                Post
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <script th:src="@{https://code.jquery.com/jquery-1.10.2.min.js}"></script>
    <script
      th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js}"
    ></script>
  </body>
</html>
